<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
</head>


<body>

<style>
    #pieces {
        border: 0;
        font-family: monospace;
        font-size: large;
    }

    .piece-span {
        border: 0;
    }

    .piece-span-space {
        border: 0;
    }

</style>

<div class="container">

    <div class="row">
        <h2> Sentence Piece Demo </h2>
        <div class="col-12">
            <form id="submit-form">
                <div class="form-row">
                    <div class="form-group col-md-12">

                        <label for="language" class="col-form-label">Language</label>
                        <select class="form-control" id="language">
                            <option value="en">English</option>
                            <option value="es">Spanish</option>
                            <option value="fr">French</option>
                            <option value="de">German</option>
                            <option value="ar">Arabic</option>
                            <option value="hi">Hindi</option>
                            <option value="hi">Hindi</option>
                            <option value="mr">Marathi</option>
                        </select>

                        <label for="text" class="col-form-label">Text</label>
                        <input class="form-control" id="text" placeholder="Input your text..." type="text">

                    </div>
                </div>
                <button type="submit" class="btn btn-primary" id="submit">Make into Sentence Piece</button>
                <button type="submit" class="btn btn-primary" id="get-another-example"> Get Another Example </button>
            </form>
        </div>
    </div>

    <div class="row">
        <p>
            See <a href="https://github.com/google/sentencepiece" target=""> Sentence Piece </a> for more explanation.
        </p>
        <div class="col-12" id="pieces" dir="auto">
        </div>
    </div>

</div><!-- /.container -->



<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>

<script>
    // var base_url = "http://localhost:8000/";

    var base_url = "https://alantian.net";

    async function get_sample(e) {
        e.preventDefault();
        var lang = $('#language').val()
        var url = base_url + '/sp/sample/' + lang;
        var p = await fetch(url, {method: 'GET'});
        var o = await p.json();
        console.log(o);
        $('#text').val(o["sent"])

        return false;
    }

    async function sp(e) {
        e.preventDefault();
        var lang = $('#language').val()
        var url = base_url + '/sp/sp/' + lang;
        console.log(url);
        var form = new FormData();
        form.append('text', $('#text').val());
        var p = await fetch(url, {
            method: 'POST',
            body: form
        });
        var o = await p.json();
        console.log(o);

        $('#pieces').empty();
        o['result'].forEach(function(elem){
            if (! elem.startsWith('(-)')){
                // $('#pieces').append( "<span class=\"piece-span-space\"> </span>");
            }
            $('#pieces').append( "<span class=\"piece-span\">" + elem + "</span>" );
        });

        return false;
    }

    // document.addEventListener("DOMContentLoaded", init);
    document.querySelector("#submit").onclick = sp;
    document.querySelector("#get-another-example").onclick = get_sample;
</script>



</body></html>